<%= content_for :pusher do %>
    <script src="http://js.pusher.com/2.0/pusher.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        // Enable pusher logging - don't include this in production
        Pusher.log = function (message) {
            if (window.console && window.console.log) window.console.log(message);
        };

        // Flash fallback logging - don't include this in production
        WEB_SOCKET_DEBUG = true;

        var pusher = new Pusher('<%= Pusher.key %>');
        var channel = pusher.subscribe('<%= @channel %>');
        channel.bind('error', function (data) {
            alert(data['error']);
        });
        channel.bind('images', function (data) {
            $('#images').html(data['images']);
        });
    </script>
<% end %>

<%= simple_form_for @pin do |f| %>
    <%= f.input :product_url, as: :string %>
    <%= f.submit %>
<% end %>

<div id="images"></div>

<h1>New pin</h1>

<%= render 'form' %>

<%= link_to 'Back', pins_path %>
